(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{XdEn:function(t,e,i){"use strict";i.r(e),i.d(e,"ItemsModule",(function(){return kt}));var a=i("PCNd"),r=i("tyNb"),c=function(t){return t.available="TRUE",t.notAvailable="FALSE",t.notify="NOTIFY",t}({}),o=i("Xibt"),n=i("2Vo4"),s=i("fXoL");let m=(()=>{class t{constructor(){this.items=new n.a({}),this.editItem=new n.a({}),this.itemTypes=new n.a([{name:"Sellable",value:"SELLABLE"},{name:"Packaging Material",value:"PACKAGING_MATERIAL"},{name:"Raw Material",value:"RAW_MATERIAL"}]),this.isItemsSet=!1,this.isItemDetailsSet=!1}getItemList(){return this.items.asObservable()}setItemList(t){this.isItemsSet=!0,this.items.next(t)}getEditItem(){return this.editItem.asObservable()}setEditItem(t){this.isItemDetailsSet=!0,this.editItem.next(t)}getItemTypes(){return this.itemTypes.asObservable()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=s.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var l=i("vkgz"),b=i("AytR"),u=i("tk/3");let d=(()=>{class t{constructor(t){this.http=t,this.baseURl=b.a.SERVER_ORIGIN}getItemList(t=1,e=5,i="",a){let r=this.baseURl+`/api/item/get_admin_item_list?currentPage=${t}&currentPageSize=${e}`;return null!=i&&null!=i&&""!=i.trim()&&(r+="&item_type="+i),null!=a&&null!=a&&(r+="&availability_status="+a),this.http.get(r)}deleteItem(t){return this.http.delete(this.baseURl+"/api/item/delete_Item/"+t)}getItemDetailsById(t){return this.http.get(this.baseURl+"/api/item/get_Itemdetail?item_id="+t)}updateActivationStatus(t,e){return this.http.put(this.baseURl+"/api/item/update_Active_Deactive_Item",{item_id:e,is_active:t})}newitem(t){return this.http.post(this.baseURl+"/api/item/add_Item",t)}updateItem(t){return this.http.put(this.baseURl+"/api/item/update/"+t._id,t)}}return t.\u0275fac=function(e){return new(e||t)(s.Yb(u.b))},t.\u0275prov=s.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var p=i("5eHb");let h=(()=>{class t{constructor(t,e,i){this.api=t,this.state=e,this.toster=i}loadItemList(t=1,e=200,i="",a=null){this.api.getItemList(t,e,i,a).subscribe(t=>{this.state.setItemList(t)},t=>console.error("api call error from load items ",t))}getItemList(t=1,e=200,i="",a){return this.state.isItemsSet||this.loadItemList(t,e,i,a),this.state.getItemList().pipe(Object(l.a)(t=>t))}getSallableItemList(){return this.api.getItemList(1,200,"SELLABLE").pipe(Object(l.a)(t=>t))}newItem(t){return this.api.newitem(t).toPromise().then(t=>(this.loadItemList(),this.toster.success("Item Successfully Created","Success",{timeOut:3e3}),t)).catch(t=>{throw console.error("api call error from new Item ",t),t})}deleteItem(t){return this.api.deleteItem(t).toPromise().then(t=>(this.toster.success("Item Successfully Deleted","Success",{timeOut:3e3}),t)).catch(t=>{throw console.error("api call error from Delete Item",t),t})}getItemDetails(t){return this.state.isItemDetailsSet||this.loadItemDetails(t),this.state.getEditItem().pipe(Object(l.a)(t=>t))}loadItemDetails(t){return this.api.getItemDetailsById(t).toPromise().then(t=>(this.state.setEditItem(t.item),t)).catch(t=>{throw console.error("api call error from load Item Details",t),t})}updateItem(t){return this.api.updateItem(t).toPromise().then(t=>(this.loadItemList(),this.toster.success("Item Successfully Updated","Success",{timeOut:3e3}),t)).catch(t=>{throw console.error("api call error from Update item ",t),t})}changeActivationStatus(t){return this.api.updateActivationStatus(t.is_active,t._id).toPromise().then(t=>(this.toster.success("Unit Successfully Updated","Success",{timeOut:3e3}),t)).catch(t=>{throw console.error("api call error from change activation status Unit",t),t})}getItemTypes(){return this.state.getItemTypes().pipe(Object(l.a)(t=>t))}}return t.\u0275fac=function(e){return new(e||t)(s.Yb(d),s.Yb(m),s.Yb(p.b))},t.\u0275prov=s.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var g=i("Dh3D"),f=i("+0xr"),T=i("ey9i"),v=function(t){return t.ADMIN="ADMIN",t.DEPO="DEPO",t.RETAILER="RETAILER",t.PURCHASE_MANAGER="PURCHASE_MANAGER",t.DELIVERY_BOY="DELIVERY_BOY",t.HAWKER="HAWKER",t.CUSTOMER="CUSTOMER",t.MANUFACTURING_PLANT="MANUFACTURING_PLANT",t.SUPPLIER="SUPPLIER",t}({}),C=i("tgey"),y=i("bTqV"),I=i("XiUz"),U=i("Wp6s"),P=i("3Pt+"),S=i("kmnG"),F=i("d3UM"),_=i("ofXK"),R=i("M9IT"),N=i("FKr1"),L=i("1jcm"),D=i("zkoq"),w=i("NFeN");function E(t,e){if(1&t&&(s.Ub(0,"mat-option",27),s.Pc(1),s.Tb()),2&t){const t=e.$implicit;s.pc("value",t.value),s.Cb(1),s.Qc(t.name)}}function O(t,e){if(1&t&&(s.Ub(0,"mat-option",27),s.Pc(1),s.Tb()),2&t){const t=e.$implicit;s.pc("value",t.value),s.Cb(1),s.Qc(t.name)}}function A(t,e){1&t&&(s.Ub(0,"th",28),s.Pc(1," Position "),s.Tb())}const M=function(){return{standalone:!0}};function x(t,e){if(1&t){const t=s.Vb();s.Ub(0,"td",29),s.Ub(1,"input",30),s.cc("change",(function(){s.Dc(t);const i=e.$implicit;return s.gc().categoryPositionChanged(i)}))("ngModelChange",(function(i){return s.Dc(t),e.$implicit.position=i})),s.Tb(),s.Tb()}if(2&t){const t=e.$implicit;s.Cb(1),s.pc("ngModelOptions",s.rc(2,M))("ngModel",t.position)}}function k(t,e){1&t&&(s.Ub(0,"th",28),s.Pc(1," Name "),s.Tb())}function q(t,e){if(1&t&&(s.Ub(0,"td",29),s.Pc(1),s.Tb()),2&t){const t=e.$implicit;s.Cb(1),s.Rc(" ",t.name," ")}}function V(t,e){1&t&&(s.Ub(0,"th",28),s.Pc(1," Second Name "),s.Tb())}function $(t,e){if(1&t&&(s.Ub(0,"td",29),s.Pc(1),s.Tb()),2&t){const t=e.$implicit;s.Cb(1),s.Rc(" ",t.secondary_name," ")}}function B(t,e){1&t&&(s.Ub(0,"th",28),s.Pc(1," Category "),s.Tb())}function K(t,e){if(1&t&&(s.Ub(0,"td",29),s.Pc(1),s.Tb()),2&t){const t=e.$implicit;s.Cb(1),s.Rc(" ",t.category_id?t.category_id.name:""," ")}}function G(t,e){1&t&&(s.Ub(0,"th",31),s.Pc(1," Image "),s.Tb())}function z(t,e){if(1&t&&(s.Ub(0,"td",29),s.Pb(1,"img",32),s.Tb()),2&t){const t=e.$implicit;s.Cb(1),s.qc("src",t.thumbnail,s.Fc)}}function j(t,e){1&t&&(s.Ub(0,"th",28),s.Pc(1," Type "),s.Tb())}function H(t,e){if(1&t&&(s.Ub(0,"td",29),s.Pc(1),s.Tb()),2&t){const t=e.$implicit,i=s.gc();s.Cb(1),s.Rc(" ",i.itemTypes[t.type]," ")}}function Q(t,e){1&t&&(s.Ub(0,"th",31),s.Pc(1," Price "),s.Tb())}function Y(t,e){if(1&t&&(s.Ub(0,"td",29),s.Pc(1),s.Tb()),2&t){const t=e.$implicit;s.Cb(1),s.Rc(" ",t.price," ")}}function W(t,e){1&t&&(s.Ub(0,"th",31),s.Pc(1," Quantity "),s.Tb())}function X(t,e){if(1&t&&(s.Ub(0,"td",29),s.Pc(1),s.Tb()),2&t){const t=e.$implicit;s.Cb(1),s.Qc(t.item_volume)}}function J(t,e){1&t&&(s.Ub(0,"th",28),s.Pc(1," Active "),s.Tb())}function Z(t,e){if(1&t){const t=s.Vb();s.Ub(0,"td",29),s.Ub(1,"mat-slide-toggle",33),s.cc("ngModelChange",(function(i){return s.Dc(t),e.$implicit.is_active=i}))("change",(function(){s.Dc(t);const i=e.$implicit;return s.gc().changeActivationStatus(i)})),s.Tb(),s.Tb()}if(2&t){const t=e.$implicit;s.Cb(1),s.pc("ngModel",t.is_active)}}function tt(t,e){1&t&&(s.Ub(0,"th",28),s.Pc(1," Controls "),s.Tb())}const et=function(){return[]};function it(t,e){if(1&t){const t=s.Vb();s.Ub(0,"td",29),s.Ub(1,"mat-grid-list",34),s.Ub(2,"mat-grid-tile"),s.Ub(3,"button",35),s.cc("click",(function(){s.Dc(t);const i=e.$implicit;return s.gc().navigateToEdit(i._id)})),s.Ub(4,"mat-icon",36),s.Pc(5,"create"),s.Tb(),s.Tb(),s.Tb(),s.Ub(6,"mat-grid-tile"),s.Ub(7,"button",37),s.cc("click",(function(){s.Dc(t);const i=e.$implicit;return s.gc().deleteIcon(i._id)})),s.Ub(8,"mat-icon",38),s.Pc(9,"delete"),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Tb()}2&t&&(s.Cb(3),s.pc("routerLink",s.rc(1,et)))}function at(t,e){1&t&&s.Pb(0,"tr",39)}function rt(t,e){1&t&&s.Pb(0,"tr",40)}const ct=function(){return[5,10,25]};let ot=(()=>{class t{constructor(t,e,i,a){this.router=t,this.settingService=e,this.facade=i,this.confirmService=a,this.displayedColumns=[],this.itemTypeList=[],this.itemTypes={SELLABLE:"Sellable",PACKAGING_MATERIAL:"Packaging Material",RAW_MATERIAL:"Raw Material"},this.searchItemType="",this.availabilityStatus=null,this.availabilityList=[{name:"Available",value:c.available},{name:"Not Available",value:c.notAvailable},{name:"Notify",value:c.notify}],this.currentRole=this.settingService.user.role_id.type||"User",this.pageDetails={currentPage:1,itemsPerPage:10,totalPages:3,totalRecords:200},this.totalBanner=0}ngOnInit(){this.facade.loadItemList(this.pageDetails.currentPage,this.pageDetails.itemsPerPage,this.searchItemType,this.availabilityStatus),this.facade.getItemList(this.pageDetails.currentPage,this.pageDetails.itemsPerPage,this.searchItemType,c).subscribe(t=>{this.dataSource=new f.p(t.data),this.dataSource.sort=this.sort}),this.facade.getItemTypes().subscribe(t=>{this.itemTypeList=t}),this.setRoleBasedColumn()}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}pageEvent(t){this.pageDetails.itemsPerPage=t.pageSize,this.pageDetails.currentPage=t.pageIndex+1,this.facade.loadItemList(this.pageDetails.currentPage,t.pageSize,this.searchItemType,this.availabilityStatus)}deleteIcon(t){this.confirmService.confirm("Are you sure want to delete this Item?","Confirm").subscribe(e=>{1==e&&this.facade.deleteItem(t).then(t=>this.facade.loadItemList(this.pageDetails.currentPage,this.pageDetails.itemsPerPage,this.searchItemType,this.availabilityStatus))})}navigateToEdit(t){this.facade.loadItemDetails(t).then(e=>{this.router.navigate(["items","edit",t])})}filterItem(){this.facade.loadItemList(this.pageDetails.currentPage,this.pageDetails.itemsPerPage,this.searchItemType,this.availabilityStatus)}resetFilter(){this.searchItemType="",this.availabilityStatus=null}changeActivationStatus(t){let e=Object.assign({},t);this.facade.changeActivationStatus(e).then(t=>{this.facade.loadItemList(this.pageDetails.currentPage,this.pageDetails.itemsPerPage,this.searchItemType,this.availabilityStatus)})}setRoleBasedColumn(){switch(this.currentRole){case v.ADMIN:this.displayedColumns=["thumbnail","position","name","price","type","is_active","category","controls"];break;case v.DEPO:case v.HAWKER:this.displayedColumns=["thumbnail","position","name","category","item_volume","price","controls"];break;default:this.displayedColumns=["thumbnail","position","name","category"]}}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(r.f),s.Ob(T.d),s.Ob(h),s.Ob(o.a))},t.\u0275cmp=s.Ib({type:t,selectors:[["app-items-components-item-list"]],viewQuery:function(t,e){var i;1&t&&s.Sc(g.a,!0),2&t&&s.yc(i=s.dc())&&(e.sort=i.first)},decls:62,vars:11,consts:[["mat-raised-button","","aria-label","View basic sidenav example","color","primary","routerLink","new"],["fxLayout","row wrap",1,"matero-row"],["fxFlex","100",1,"matero-col"],["fxFlex","25","fxFlex.lt-sm","100",1,"matero-col"],["placeholder","Item Type","name","filterType",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Type","name","filterType",3,"ngModel","ngModelChange"],["mat-raised-button","","color","primary",2,"margin-right","5px",3,"click"],["mat-raised-button","",3,"click"],[1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","position"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","secondary_name"],["matColumnDef","category"],["matColumnDef","thumbnail"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","type"],["matColumnDef","price"],["matColumnDef","item_volume"],["matColumnDef","is_active"],["matColumnDef","controls"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize","pageSizeOptions","page"],[3,"value"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["type","number",2,"max-width","70px",3,"ngModelOptions","ngModel","change","ngModelChange"],["mat-header-cell",""],["alt","Item Image","width","100px","height","50px",3,"src"],["color","primary",3,"ngModel","ngModelChange","change"],["cols","2","rowHeight","50px"],["mat-icon-button","","aria-label","Edit",3,"routerLink","click"],["color","primary"],["mat-icon-button","","aria-label","Delete",3,"click"],["color","accent"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(s.Pb(0,"page-header"),s.Ub(1,"section"),s.Ub(2,"a",0),s.Pc(3," Add New "),s.Tb(),s.Tb(),s.Pb(4,"br"),s.Ub(5,"div",1),s.Ub(6,"div",2),s.Ub(7,"mat-card"),s.Ub(8,"mat-card-title"),s.Pc(9,"Filter"),s.Tb(),s.Ub(10,"form"),s.Ub(11,"mat-form-field",3),s.Ub(12,"mat-label"),s.Pc(13,"Item Type"),s.Tb(),s.Ub(14,"mat-select",4),s.cc("ngModelChange",(function(t){return e.searchItemType=t})),s.Nc(15,E,2,2,"mat-option",5),s.Tb(),s.Tb(),s.Ub(16,"mat-form-field",3),s.Ub(17,"mat-label"),s.Pc(18,"Availability"),s.Tb(),s.Ub(19,"mat-select",6),s.cc("ngModelChange",(function(t){return e.availabilityStatus=t})),s.Nc(20,O,2,2,"mat-option",5),s.Tb(),s.Tb(),s.Ub(21,"div",3),s.Ub(22,"button",7),s.cc("click",(function(){return e.filterItem()})),s.Pc(23,"Search"),s.Tb(),s.Ub(24,"button",8),s.cc("click",(function(){return e.resetFilter()})),s.Pc(25,"Reset"),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Ub(26,"div",9),s.Ub(27,"table",10),s.Sb(28,11),s.Ub(29,"form"),s.Nc(30,A,2,0,"th",12),s.Nc(31,x,2,3,"td",13),s.Tb(),s.Rb(),s.Sb(32,14),s.Nc(33,k,2,0,"th",12),s.Nc(34,q,2,1,"td",13),s.Rb(),s.Sb(35,15),s.Nc(36,V,2,0,"th",12),s.Nc(37,$,2,1,"td",13),s.Rb(),s.Sb(38,16),s.Nc(39,B,2,0,"th",12),s.Nc(40,K,2,1,"td",13),s.Rb(),s.Sb(41,17),s.Nc(42,G,2,0,"th",18),s.Nc(43,z,2,1,"td",13),s.Rb(),s.Sb(44,19),s.Nc(45,j,2,0,"th",12),s.Nc(46,H,2,1,"td",13),s.Rb(),s.Sb(47,20),s.Nc(48,Q,2,0,"th",18),s.Nc(49,Y,2,1,"td",13),s.Rb(),s.Sb(50,21),s.Nc(51,W,2,0,"th",18),s.Nc(52,X,2,1,"td",13),s.Rb(),s.Sb(53,22),s.Nc(54,J,2,0,"th",12),s.Nc(55,Z,2,1,"td",13),s.Rb(),s.Sb(56,23),s.Nc(57,tt,2,0,"th",12),s.Nc(58,it,10,2,"td",13),s.Rb(),s.Nc(59,at,1,0,"tr",24),s.Nc(60,rt,1,0,"tr",25),s.Tb(),s.Ub(61,"mat-paginator",26),s.cc("page",(function(t){return e.pageEvent(t)})),s.Tb(),s.Tb()),2&t&&(s.Cb(14),s.pc("ngModel",e.searchItemType),s.Cb(1),s.pc("ngForOf",e.itemTypeList),s.Cb(4),s.pc("ngModel",e.availabilityStatus),s.Cb(1),s.pc("ngForOf",e.availabilityList),s.Cb(7),s.pc("dataSource",e.dataSource),s.Cb(32),s.pc("matHeaderRowDef",e.displayedColumns),s.Cb(1),s.pc("matRowDefColumns",e.displayedColumns),s.Cb(1),s.pc("length",e.pageDetails.totalRecords)("pageSize",e.pageDetails.itemsPerPage)("pageSizeOptions",s.rc(10,ct)))},directives:[C.a,y.a,r.i,I.c,I.a,U.a,U.c,P.x,P.q,P.r,S.c,S.g,F.a,P.p,P.s,_.n,y.b,f.o,g.a,f.c,f.i,f.b,f.k,f.n,R.a,N.p,f.h,g.b,f.a,P.t,P.d,L.a,D.a,D.c,r.g,w.a,f.j,f.m],styles:["table[_ngcontent-%COMP%]{width:100%}.mat-form-field[_ngcontent-%COMP%]{font-size:14px;width:100%}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{width:auto}"]}),t})();var nt=i("uEtv"),st=i("FtGj"),mt=i("rGne"),lt=i("qFsG"),bt=i("A5z7"),ut=i("sYmb");function dt(t,e){1&t&&(s.Ub(0,"mat-error"),s.Pc(1),s.hc(2,"translate"),s.Tb()),2&t&&(s.Cb(1),s.Rc(" ",s.ic(2,1,"validations.required")," "))}function pt(t,e){1&t&&(s.Ub(0,"mat-error"),s.Pc(1),s.hc(2,"translate"),s.Tb()),2&t&&(s.Cb(1),s.Rc(" ",s.ic(2,1,"validations.required")," "))}function ht(t,e){1&t&&(s.Ub(0,"mat-error"),s.Pc(1),s.hc(2,"translate"),s.Tb()),2&t&&(s.Cb(1),s.Rc(" ",s.ic(2,1,"validations.required")," "))}function gt(t,e){if(1&t&&(s.Ub(0,"mat-option",30),s.Pc(1),s.Tb()),2&t){const t=e.$implicit;s.pc("value",t._id),s.Cb(1),s.Qc(t.name)}}function ft(t,e){1&t&&(s.Ub(0,"mat-error"),s.Pc(1),s.hc(2,"translate"),s.Tb()),2&t&&(s.Cb(1),s.Rc(" ",s.ic(2,1,"validations.required")," "))}function Tt(t,e){if(1&t&&(s.Ub(0,"mat-option",30),s.Pc(1),s.Tb()),2&t){const t=e.$implicit;s.pc("value",t._id),s.Cb(1),s.Qc(t.name)}}function vt(t,e){1&t&&(s.Ub(0,"mat-error"),s.Pc(1),s.hc(2,"translate"),s.Tb()),2&t&&(s.Cb(1),s.Rc(" ",s.ic(2,1,"validations.required")," "))}function Ct(t,e){if(1&t&&(s.Ub(0,"mat-option",30),s.Pc(1),s.Tb()),2&t){const t=e.$implicit;s.pc("value",t.value),s.Cb(1),s.Qc(t.name)}}function yt(t,e){1&t&&(s.Ub(0,"mat-error"),s.Pc(1),s.hc(2,"translate"),s.Tb()),2&t&&(s.Cb(1),s.Rc(" ",s.ic(2,1,"validations.required")," "))}function It(t,e){if(1&t&&(s.Ub(0,"mat-option",30),s.Pc(1),s.Tb()),2&t){const t=e.$implicit;s.pc("value",t._id),s.Cb(1),s.Qc(t.name)}}function Ut(t,e){1&t&&(s.Ub(0,"mat-error"),s.Pc(1),s.hc(2,"translate"),s.Tb()),2&t&&(s.Cb(1),s.Rc(" ",s.ic(2,1,"validations.required")," "))}function Pt(t,e){if(1&t&&(s.Ub(0,"mat-option",30),s.Pc(1),s.Tb()),2&t){const t=e.$implicit;s.pc("value",t._id),s.Cb(1),s.Qc(t.name)}}function St(t,e){1&t&&(s.Ub(0,"mat-error"),s.Pc(1),s.hc(2,"translate"),s.Tb()),2&t&&(s.Cb(1),s.Rc(" ",s.ic(2,1,"validations.required")," "))}function Ft(t,e){1&t&&(s.Ub(0,"mat-error"),s.Pc(1),s.hc(2,"translate"),s.Tb()),2&t&&(s.Cb(1),s.Rc(" ",s.ic(2,1,"validations.required")," "))}function _t(t,e){if(1&t){const t=s.Vb();s.Ub(0,"mat-chip",31),s.cc("removed",(function(){s.Dc(t);const i=e.$implicit;return s.gc().removetag(i)})),s.Pc(1),s.Ub(2,"mat-icon",32),s.Pc(3,"cancel"),s.Tb(),s.Tb()}if(2&t){const t=e.$implicit;s.Cb(1),s.Rc(" ",t," ")}}function Rt(t,e){1&t&&(s.Ub(0,"mat-error"),s.Pc(1),s.hc(2,"translate"),s.Tb()),2&t&&(s.Cb(1),s.Rc(" ",s.ic(2,1,"validations.required")," "))}function Nt(t,e){if(1&t){const t=s.Vb();s.Ub(0,"mat-chip",31),s.cc("removed",(function(){s.Dc(t);const i=e.$implicit;return s.gc().removepic(i)})),s.Pc(1),s.Ub(2,"mat-icon",32),s.Pc(3,"cancel"),s.Tb(),s.Tb()}if(2&t){const t=e.$implicit;s.Cb(1),s.Rc(" ",t," ")}}function Lt(t,e){1&t&&(s.Ub(0,"mat-error"),s.Pc(1),s.hc(2,"translate"),s.Tb()),2&t&&(s.Cb(1),s.Rc(" ",s.ic(2,1,"validations.required")," "))}function Dt(t,e){1&t&&(s.Ub(0,"mat-error"),s.Pc(1),s.hc(2,"translate"),s.Tb()),2&t&&(s.Cb(1),s.Rc(" ",s.ic(2,1,"validations.required")," "))}function wt(t,e){1&t&&(s.Ub(0,"mat-error"),s.Pc(1),s.hc(2,"translate"),s.Tb()),2&t&&(s.Cb(1),s.Rc(" ",s.ic(2,1,"validations.required")," "))}const Et=function(){return["home","items","new"]},Ot=function(){return["/items"]};let At=(()=>{class t{constructor(t,e,i,a,r,c){this.fb=t,this.router=e,this.activeRoute=i,this.facade=a,this.unitFacde=r,this.categoryFacade=c,this.recommendedList=[],this.isEditMode=!1,this.activeEditId="",this.separatorKeysCodes=[st.g,st.c],this.cateTagValues=[],this.subCateTagValues=[],this.itemForm=this.fb.group({name:["",[P.w.required]],secondary_name:[""],price:[0],is_active:[!0],category_id:[""],unit_id:[""],item_type:[""],description:[""],benefits:[""],category_tags:[[]],thumbnail:[""],picture:[[]],recommended_items:[[]],subCategory_ids:[[]]}),this.activeRoute.params.subscribe(t=>{null!=t.id&&null!=t.id&&""!=t.id&&(this.isEditMode=!0,this.activeEditId=t.id)})}ngOnInit(){this.categoryFacade.loadParentCategories(),this.unitFacde.loadUnites(1,500),this.categoryFacade.getParentCategories().subscribe(t=>{this.categoryList=t}),this.categoryFacade.getCategoriesByParentId().subscribe(t=>{this.subCategoryList=t.data}),this.unitFacde.getUnites().subscribe(t=>{this.unitList=t.data}),this.facade.getItemTypes().subscribe(t=>{this.itemTypeList=t}),this.facade.getSallableItemList().subscribe(t=>{this.recommendedList=t.data}),this.isEditMode&&this.facade.getItemDetails(this.activeEditId).subscribe(t=>{let e=Object.assign({},t);this.itemForm.patchValue(t),this.itemForm.patchValue({item_type:e.type})},t=>console.error(t))}get is_active_value(){return!!this.itemForm.get("is_active").value&&this.itemForm.get("is_active").value}onFormSubmit(t){if(console.log("form value ",this.itemForm.value,this.itemForm.valid),this.itemForm.valid)if(this.isEditMode){let t=this.itemForm.value;t._id=this.activeEditId,this.facade.updateItem(t).then(t=>{this.itemForm.reset(),this.router.navigate(["items"])})}else this.facade.newItem(this.itemForm.value).then(t=>{this.itemForm.reset(),this.router.navigate(["items"])})}addtag(t){const e=t.input,i=t.value;let a=[...this.itemForm.get("category_tags").value];(i||"").trim()&&(a.push(i.trim()),this.itemForm.get("category_tags").setValue(a)),e&&(e.value="")}removetag(t){let e=[...this.itemForm.get("category_tags").value];const i=e.indexOf(t);i>=0&&(e.splice(i,1),this.itemForm.get("category_tags").setValue(e))}addpic(t){const e=t.input,i=t.value;let a=[...this.itemForm.get("picture").value];(i||"").trim()&&(a.push(i.trim()),this.itemForm.get("picture").setValue(a)),e&&(e.value="")}removepic(t){let e=[...this.itemForm.get("picture").value];const i=e.indexOf(t);i>=0&&(e.splice(i,1),this.itemForm.get("picture").setValue(e))}onCategorySelectionChange(){this.cateTagValues=[];let t=this.itemForm.get("category_id").value;this.categoryList.filter(e=>{t==e._id&&this.cateTagValues.push(e.name)}),this.itemForm.patchValue({category_tags:[].concat(...this.cateTagValues)}),this.itemForm.get("subCategory_ids").setValue([]),this.loadSubCategories(t)}onSubCategorySelectionChange(){this.subCateTagValues=[];let t=this.itemForm.get("subCategory_ids").value;this.subCategoryList.filter(e=>{t.indexOf(e._id)>=0&&this.subCateTagValues.push(e.name)}),this.itemForm.patchValue({category_tags:[].concat(...this.cateTagValues,this.subCateTagValues)})}loadSubCategories(t){this.categoryFacade.loadCategories(1,200,t,"")}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(P.f),s.Ob(r.f),s.Ob(r.a),s.Ob(h),s.Ob(mt.a),s.Ob(nt.a))},t.\u0275cmp=s.Ib({type:t,selectors:[["app-items-components-item-add"]],decls:104,vars:34,consts:[[3,"title","nav"],["fxLayout","row wrap",1,"matero-row"],["fxFlex","100","fxFlex.lt-sm","100",1,"matero-col"],[1,"form-field-full",3,"formGroup","submit"],["fxLayout","row wrap","fxLayoutGap","8px grid"],["fxFlex","25","fxFlex.lt-sm","100"],["matInput","","placeholder","Name","formControlName","name","required",""],[4,"ngIf"],["matInput","","placeholder","Secondary Name","formControlName","secondary_name","required",""],["matInput","","placeholder","Price","formControlName","price","required","","type","number"],["formControlName","is_active","color","primary",2,"margin-top","20px"],["formControlName","category_id","placeholder","Category","required","",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","subCategory_ids","placeholder","Sub Category","required","","multiple","",3,"selectionChange"],["formControlName","item_type","placeholder","Type","required",""],["formControlName","unit_id","placeholder","Unit","required",""],["fxFlex","50","fxFlex.lt-sm","100"],["formControlName","recommended_items","placeholder","Recommendation","multiple","","required",""],["matInput","","placeholder","Thumbnail","formControlName","thumbnail","required",""],["aria-label","Tags"],["chipList",""],["selectable","true","removable","true",3,"removed",4,"ngFor","ngForOf"],["placeholder","Tags",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],["aria-label","Pictures"],["picList",""],["placeholder","Pictures",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],["matInput","","placeholder","Description","formControlName","description","required",""],["matInput","","placeholder","Benefits","formControlName","benefits","required",""],["mat-raised-button","","color","primary","type","submit",1,"m-t-8",2,"margin-right","5px"],["mat-raised-button","","type","button",1,"m-t-8",3,"routerLink"],[3,"value"],["selectable","true","removable","true",3,"removed"],["matChipRemove",""]],template:function(t,e){if(1&t&&(s.Pb(0,"page-header",0),s.Ub(1,"div",1),s.Ub(2,"div",2),s.Ub(3,"mat-card"),s.Ub(4,"mat-card-title"),s.Pc(5),s.Tb(),s.Ub(6,"form",3),s.cc("submit",(function(t){return e.onFormSubmit(t)})),s.Ub(7,"div",4),s.Ub(8,"div",5),s.Ub(9,"mat-form-field"),s.Ub(10,"mat-label"),s.Pc(11,"Name"),s.Tb(),s.Pb(12,"input",6),s.Nc(13,dt,3,3,"mat-error",7),s.Tb(),s.Tb(),s.Ub(14,"div",5),s.Ub(15,"mat-form-field"),s.Ub(16,"mat-label"),s.Pc(17,"Secondary Name"),s.Tb(),s.Pb(18,"input",8),s.Nc(19,pt,3,3,"mat-error",7),s.Tb(),s.Tb(),s.Ub(20,"div",5),s.Ub(21,"mat-form-field"),s.Ub(22,"mat-label"),s.Pc(23,"Price"),s.Tb(),s.Pb(24,"input",9),s.Nc(25,ht,3,3,"mat-error",7),s.Tb(),s.Tb(),s.Ub(26,"div",5),s.Ub(27,"mat-slide-toggle",10),s.Pc(28),s.Tb(),s.Tb(),s.Ub(29,"div",5),s.Ub(30,"mat-form-field"),s.Ub(31,"mat-label"),s.Pc(32,"Category"),s.Tb(),s.Ub(33,"mat-select",11),s.cc("selectionChange",(function(){return e.onCategorySelectionChange()})),s.Nc(34,gt,2,2,"mat-option",12),s.Tb(),s.Nc(35,ft,3,3,"mat-error",7),s.Tb(),s.Tb(),s.Ub(36,"div",5),s.Ub(37,"mat-form-field"),s.Ub(38,"mat-label"),s.Pc(39,"Sub Category"),s.Tb(),s.Ub(40,"mat-select",13),s.cc("selectionChange",(function(){return e.onSubCategorySelectionChange()})),s.Nc(41,Tt,2,2,"mat-option",12),s.Tb(),s.Nc(42,vt,3,3,"mat-error",7),s.Tb(),s.Tb(),s.Ub(43,"div",5),s.Ub(44,"mat-form-field"),s.Ub(45,"mat-label"),s.Pc(46,"Type"),s.Tb(),s.Ub(47,"mat-select",14),s.Nc(48,Ct,2,2,"mat-option",12),s.Tb(),s.Nc(49,yt,3,3,"mat-error",7),s.Tb(),s.Tb(),s.Ub(50,"div",5),s.Ub(51,"mat-form-field"),s.Ub(52,"mat-label"),s.Pc(53,"Unit"),s.Tb(),s.Ub(54,"mat-select",15),s.Nc(55,It,2,2,"mat-option",12),s.Tb(),s.Nc(56,Ut,3,3,"mat-error",7),s.Tb(),s.Tb(),s.Ub(57,"div",16),s.Ub(58,"mat-form-field"),s.Ub(59,"mat-label"),s.Pc(60,"Recommendation"),s.Tb(),s.Ub(61,"mat-select",17),s.Nc(62,Pt,2,2,"mat-option",12),s.Tb(),s.Nc(63,St,3,3,"mat-error",7),s.Tb(),s.Tb(),s.Ub(64,"div",16),s.Ub(65,"mat-form-field"),s.Ub(66,"mat-label"),s.Pc(67,"Thumbnail"),s.Tb(),s.Pb(68,"input",18),s.Nc(69,Ft,3,3,"mat-error",7),s.Tb(),s.Tb(),s.Ub(70,"div",16),s.Ub(71,"mat-form-field"),s.Ub(72,"mat-label"),s.Pc(73,"Tags"),s.Tb(),s.Ub(74,"mat-chip-list",19,20),s.Nc(76,_t,4,1,"mat-chip",21),s.Ub(77,"input",22),s.cc("matChipInputTokenEnd",(function(t){return e.addtag(t)})),s.Tb(),s.Tb(),s.Nc(78,Rt,3,3,"mat-error",7),s.Tb(),s.Tb(),s.Ub(79,"div",16),s.Ub(80,"mat-form-field"),s.Ub(81,"mat-label"),s.Pc(82,"Pictures"),s.Tb(),s.Ub(83,"mat-chip-list",23,24),s.Nc(85,Nt,4,1,"mat-chip",21),s.Ub(86,"input",25),s.cc("matChipInputTokenEnd",(function(t){return e.addpic(t)})),s.Tb(),s.Tb(),s.Nc(87,Lt,3,3,"mat-error",7),s.Tb(),s.Tb(),s.Ub(88,"div",16),s.Ub(89,"mat-form-field"),s.Ub(90,"mat-label"),s.Pc(91,"Description"),s.Tb(),s.Pb(92,"textarea",26),s.Nc(93,Dt,3,3,"mat-error",7),s.Tb(),s.Tb(),s.Ub(94,"div",16),s.Ub(95,"mat-form-field"),s.Ub(96,"mat-label"),s.Pc(97,"Benefits"),s.Tb(),s.Pb(98,"textarea",27),s.Nc(99,wt,3,3,"mat-error",7),s.Tb(),s.Tb(),s.Tb(),s.Ub(100,"button",28),s.Pc(101,"Save"),s.Tb(),s.Ub(102,"button",29),s.Pc(103," Back"),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Tb()),2&t){const t=s.zc(75),i=s.zc(84);s.qc("title",e.isEditMode?"Edit Item":"New Item"),s.pc("nav",s.rc(32,Et)),s.Cb(5),s.Rc("",e.isEditMode?"Edit Item":"New Item"," "),s.Cb(1),s.pc("formGroup",e.itemForm),s.Cb(7),s.pc("ngIf",e.itemForm.get("name").invalid),s.Cb(6),s.pc("ngIf",e.itemForm.get("secondary_name").invalid),s.Cb(6),s.pc("ngIf",e.itemForm.get("price").invalid),s.Cb(3),s.Rc(" ",e.is_active_value?"Active":"Inactive"," "),s.Cb(6),s.pc("ngForOf",e.categoryList),s.Cb(1),s.pc("ngIf",e.itemForm.get("category_id").invalid),s.Cb(6),s.pc("ngForOf",e.subCategoryList),s.Cb(1),s.pc("ngIf",e.itemForm.get("subCategory_ids").invalid),s.Cb(6),s.pc("ngForOf",e.itemTypeList),s.Cb(1),s.pc("ngIf",e.itemForm.get("item_type").invalid),s.Cb(6),s.pc("ngForOf",e.unitList),s.Cb(1),s.pc("ngIf",e.itemForm.get("unit_id").invalid),s.Cb(6),s.pc("ngForOf",e.recommendedList),s.Cb(1),s.pc("ngIf",e.itemForm.get("recommended_items").invalid),s.Cb(6),s.pc("ngIf",e.itemForm.get("thumbnail").invalid),s.Cb(7),s.pc("ngForOf",e.itemForm.get("category_tags").value),s.Cb(1),s.pc("matChipInputFor",t)("matChipInputSeparatorKeyCodes",e.separatorKeysCodes)("matChipInputAddOnBlur",!0),s.Cb(1),s.pc("ngIf",e.itemForm.get("category_tags").invalid),s.Cb(7),s.pc("ngForOf",e.itemForm.get("picture").value),s.Cb(1),s.pc("matChipInputFor",i)("matChipInputSeparatorKeyCodes",e.separatorKeysCodes)("matChipInputAddOnBlur",!0),s.Cb(1),s.pc("ngIf",e.itemForm.get("picture").invalid),s.Cb(6),s.pc("ngIf",e.itemForm.get("description").invalid),s.Cb(6),s.pc("ngIf",e.itemForm.get("benefits").invalid),s.Cb(3),s.pc("routerLink",s.rc(33,Ot))}},directives:[C.a,I.c,I.a,U.a,U.c,P.x,P.q,P.k,I.d,S.c,S.g,lt.b,P.d,P.p,P.i,P.v,_.o,P.t,L.a,F.a,_.n,bt.c,bt.b,y.b,r.g,S.b,N.p,bt.a,w.a,bt.d],pipes:[ut.d],styles:[""]}),t})();const Mt=[{path:"",component:ot},{path:"new",component:At},{path:"edit/:id",component:At}];let xt=(()=>{class t{}return t.\u0275mod=s.Mb({type:t}),t.\u0275inj=s.Lb({factory:function(e){return new(e||t)},imports:[[r.j.forChild(Mt)],r.j]}),t})(),kt=(()=>{class t{}return t.\u0275mod=s.Mb({type:t}),t.\u0275inj=s.Lb({factory:function(e){return new(e||t)},imports:[[a.a,xt]]}),t})()}}]);